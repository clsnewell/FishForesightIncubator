---
title: "Data Exploration & Visualization"
author: "Caroline Newell"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

In this rmd, I take SMFS_Integrate created in SMFS_Wrangling to complete the following objectives: 
Visualize
- Water Quality
- Levi's WQ Plot matching
- Lengths across WQ for each species of interest
- Seasonality of fish catch


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Load Libraries
library(tidyverse)
library(readr)
library(readxl)
library(cowplot)
library(lubridate)
library(fuzzyjoin)
```

# Visuals of Raw Data

I know we are not planning to use "age classes" as they are possibly incorrect but it is a useful measure of size differences. I know they are referred to here as "age classes" but it is similar to refer to them as size classes.

## Load Data 

```{r}
SMFS_Integrate <- read_csv("Data/SMFS_Integrate.csv") #this dataset includes all SMFS OT data from 2011-2023 data 
PresAbs<-read_csv("C:/Users/cnewe/OneDrive/Documents/Incubator/Code/FishForesightIncubator/Data/SMFS_PresAbs.csv")

```

## Water Quality

```{r}
#Make a histogram of all the water quality observed in the data.
WaQua<-Raw_AgeClasses %>% group_by(TrawlRowID) %>% 
  summarize(WaterTemperature = WaterTemperature, Salinity = Salinity, DO = DO, PctSaturation=PctSaturation, Secchi=Secchi, SpecificConductance=SpecificConductance, Month=Month, Year=Year, TowDuration=TowDuration, StationCode=StationCode) %>% distinct() #Creating a df of water quality for each unique trawl

DOplot<-WaQua %>% ggplot()+geom_freqpoly(aes(DO)) + xlab("Dissolved Oxygen (mg/L)")

Templot<-WaQua %>% ggplot()+geom_freqpoly(aes(WaterTemperature)) + xlab("Water Temperature (Celcius)")

SecchiPlot<-WaQua %>% ggplot()+geom_freqpoly(aes(Secchi)) + xlab("Secchi (cm)")

SalPlot<-WaQua %>% ggplot()+geom_freqpoly(aes(Salinity)) + xlab("Salinity (psu)")

WaQuaPlots<-plot_grid(Templot, DOplot, SalPlot, SecchiPlot, ncol = 2, labels = "AUTO")
# now add the title
title <- ggdraw() + draw_label("Frequency of Water Quality for SMFS trawls 2011-2023", fontface = 'bold', x = 0, hjust = 0) +  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7))

plot_grid(title, WaQuaPlots, ncol = 1,
  # rel_heights values control vertical title margins
  rel_heights = c(0.1, 1))


#Which sites to keep?
WaQua %>% ggplot() + geom_bar(aes(StationCode))+geom_hline(aes(yintercept=30), color="red") +theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
 #adding a cutoff of 30 to be included in the study.
#Remove the following: c("BL", "CHA1", "CHA2", "COGR", "CRD1", "CRD2", "CRD3", "CRD3.5", "CRD4", "FH1", "GR3", "GR4", "HL2", "IBI1", "LU1", "PT3", "SD2", "SUVOL", "TRDB2")

#Remove the sites in the Thesis data.
```

### Matching Levi's Alviso Dynamics Plot

I want to make Levi's plots! I need a three by four grid of boxplots as follows: By year By Month By Site

DO (%sat) Sal (psu) Temp (degC) SEC (cm)

```{r}
#All Data
SMFS_Integrate$Year<-as.factor(SMFS_Integrate$Year)
SMFS_Integrate$Month<-as.factor(SMFS_Integrate$Month)
#need cowplot
Year_DO<-SMFS_Integrate %>% ggplot(aes(x=Year, y=PctSaturation))+geom_boxplot(fill="grey")+ylab("DO (%sat)")+theme_bw() +                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Year_Sal<-SMFS_Integrate %>% ggplot(aes(x=Year, y=Salinity))+geom_boxplot(fill="grey")+ylab("SAL (ppt)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Year_Temp<-SMFS_Integrate %>% ggplot(aes(x=Year, y=WaterTemperature))+geom_boxplot(fill="grey")+ylab("TEMP (degC)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Year_SEC<- SMFS_Integrate %>% ggplot(aes(x=Year, y=Secchi))+geom_boxplot(fill="grey")+ylab("SEC (cm)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")

Month_DO<-SMFS_Integrate %>% ggplot(aes(x=Month, y=PctSaturation))+geom_boxplot(fill="grey")+ylab("DO (%sat)")+theme_bw() +                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Month_Sal<-SMFS_Integrate %>% ggplot(aes(x=Month, y=Salinity))+geom_boxplot(fill="grey")+ylab("SAL (ppt)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Month_Temp<-SMFS_Integrate %>% ggplot(aes(x=Month, y=WaterTemperature))+geom_boxplot(fill="grey")+ylab("TEMP (degC)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Month_SEC<- SMFS_Integrate %>% ggplot(aes(x=Month, y=Secchi))+geom_boxplot(fill="grey")+ylab("SEC (cm)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
sort(unique(SMFS_Integrate$StationCode)) #gives list in alphabetical order!
StationCode_DO<-SMFS_Integrate %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>%  ggplot(aes(x=StationCode, y=PctSaturation))+geom_boxplot(fill="grey")+ylab("DO (%sat)")+theme_bw() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
StationCode_Sal<-SMFS_Integrate %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>% ggplot(aes(x=StationCode, y=Salinity))+geom_boxplot(fill="grey")+ylab("SAL (ppt)")+theme_bw()+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
StationCode_Temp<-SMFS_Integrate %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>% ggplot(aes(x=StationCode, y=WaterTemperature))+geom_boxplot(fill="grey")+ylab("TEMP (degC)")+theme_bw()+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
StationCode_SEC<- SMFS_Integrate %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>% ggplot(aes(x=StationCode, y=Secchi))+geom_boxplot(fill="grey")+ylab("SEC (cm)")+theme_bw() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")

plot_grid(Year_DO, Month_DO, StationCode_DO, Year_Sal, Month_Sal, StationCode_Sal, Year_Temp, Month_Temp, StationCode_Temp, Year_SEC, Month_SEC, StationCode_SEC, nrow=4) #wait could I do this with facet wraps??? facet_grid? No, because each plot has different x,y combo... 

#Make y-axis match levi's

glimpse(PresAbs)
PresAbs$Year<-as.factor(PresAbs$Year)
PresAbs$Month<-as.factor(PresAbs$Month)
#need cowplot
Year_DO<-PresAbs %>% ggplot(aes(x=Year, y=PctSaturation))+geom_boxplot(fill="grey")+ylab("DO (%sat)")+theme_bw() +                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Year_Sal<-PresAbs %>% ggplot(aes(x=Year, y=Salinity))+geom_boxplot(fill="grey")+ylab("SAL (ppt)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Year_Temp<-PresAbs %>% ggplot(aes(x=Year, y=WaterTemperature))+geom_boxplot(fill="grey")+ylab("TEMP (degC)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Year_SEC<- PresAbs %>% ggplot(aes(x=Year, y=Secchi))+geom_boxplot(fill="grey")+ylab("SEC (cm)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")

Month_DO<-PresAbs %>% ggplot(aes(x=Month, y=PctSaturation))+geom_boxplot(fill="grey")+ylab("DO (%sat)")+theme_bw() +                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Month_Sal<-PresAbs %>% ggplot(aes(x=Month, y=Salinity))+geom_boxplot(fill="grey")+ylab("SAL (ppt)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Month_Temp<-PresAbs %>% ggplot(aes(x=Month, y=WaterTemperature))+geom_boxplot(fill="grey")+ylab("TEMP (degC)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Month_SEC<- PresAbs %>% ggplot(aes(x=Month, y=Secchi))+geom_boxplot(fill="grey")+ylab("SEC (cm)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
sort(unique(PresAbs$StationCode)) #gives list in alphabetical order!
StationCode_DO<-PresAbs %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>%  ggplot(aes(x=StationCode, y=PctSaturation))+geom_boxplot(fill="grey")+ylab("DO (%sat)")+theme_bw() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
StationCode_Sal<-PresAbs %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>% ggplot(aes(x=StationCode, y=Salinity))+geom_boxplot(fill="grey")+ylab("SAL (ppt)")+theme_bw()+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
StationCode_Temp<-PresAbs %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>% ggplot(aes(x=StationCode, y=WaterTemperature))+geom_boxplot(fill="grey")+ylab("TEMP (degC)")+theme_bw()+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
StationCode_SEC<- PresAbs %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>% ggplot(aes(x=StationCode, y=Secchi))+geom_boxplot(fill="grey")+ylab("SEC (cm)")+theme_bw() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")

plot_grid(Year_DO, Month_DO, StationCode_DO, Year_Sal, Month_Sal, StationCode_Sal, Year_Temp, Month_Temp, StationCode_Temp, Year_SEC, Month_SEC, StationCode_SEC, nrow=4) #wait could I do this with facet wraps??? facet_grid? No, because each plot has different x,y combo... 
```

## Catch of lengths for each water quality by year

Species of interest: LFS, ASH, ISS, SCP, STBK, SKG

If we see different age classes popping up in different areas of wq (for instance most age 1 to the left, age 2 to the right, we may expect differences in sensitivity to water quality by age). If there is a lot of overlap with no clear segregation across years I imagine that means there isn't substantial support for modelling the ages separately.

*NOTE: These plots are only for visual assessment of age class differences in responses to water quality variables. No effort represented in these plots.*

### Longfin Smelt

```{r}
test<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) #Adds new column that round water temperature to nearest 0.5
test$water_temp_bin

#Water Temp graph for 2011-2023
WT_LFS<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT_LFS #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO_LFS<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & Dissolved Oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) #+facet_wrap(~AgeClass, scales="free_y")
DO_LFS
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT_LFS<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)
  #facet_wrap(~Year)+
PPT_LFS

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

summary(Raw_AgeClasses$Secchi)
#Secchi Graph for SB 2011-2023
Secchi_LFS<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20)
  
Secchi_LFS

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT_LFS, DO_LFS, PPT_LFS, Secchi_LFS, ncol = 2, labels = "AUTO")
```

### American Shad

```{r}
WT_ASH<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT_ASH #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO_ASH<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) #+facet_wrap(~AgeClass, scales="free_y")
DO_ASH
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT_ASH<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)
  #facet_wrap(~Year)+
PPT_ASH

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

summary(Raw_AgeClasses$Secchi)
#Secchi Graph for SB 2011-2023
Secchi_ASH<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts. No effort \n accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20)
  
Secchi_ASH

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT_ASH, DO_ASH, PPT_ASH, Secchi_ASH, ncol = 2, labels = "AUTO")
```

### ISS

```{r}

WT_ISS<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT_ISS #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO_ISS<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) #+facet_wrap(~AgeClass, scales="free_y")
DO_ISS
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT_ISS<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)
  #facet_wrap(~Year)+
PPT_ISS

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

test<-Raw_AgeClasses %>% filter(OrganismCode %in% "ISS")
test$Secchi
#Secchi Graph for SB 2011-2023
Secchi_ISS<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts. No effort \n accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 10)
  
Secchi_ISS

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT_ISS, DO_ISS, PPT_ISS, Secchi_ISS, ncol = 2, labels = "AUTO")
```

### SCP

```{r}

WT_SCP<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT_SCP #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO_SCP<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) #+facet_wrap(~AgeClass, scales="free_y")
DO_SCP
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT_SCP<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)
  #facet_wrap(~Year)+
PPT_SCP

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

test<-Raw_AgeClasses %>% filter(OrganismCode %in% "SCP")
test$Secchi
#Secchi Graph for SB 2011-2023
Secchi_SCP<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts. No effort \n accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 10)
  
Secchi_SCP

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT_SCP, DO_SCP, PPT_SCP, Secchi_SCP, ncol = 2, labels = "AUTO")
```

### STBK

```{r}

WT_STBK<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback\n age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT_STBK #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO_STBK<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) #+facet_wrap(~AgeClass, scales="free_y")
DO_STBK
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT_STBK<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)
  #facet_wrap(~Year)+
PPT_STBK

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

test<-Raw_AgeClasses %>% filter(OrganismCode %in% "STBK")
test$Secchi
#Secchi Graph for SB 2011-2023
Secchi_STBK<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts. No effort \n accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 10)
  
Secchi_STBK

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT_STBK, DO_STBK, PPT_STBK, Secchi_STBK, ncol = 2, labels = "AUTO")
```

### SKG

```{r}
WT_SKG<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby\n age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT_SKG #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO_SKG<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) #+facet_wrap(~AgeClass, scales="free_y")
DO_SKG
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT_SKG<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)
  #facet_wrap(~Year)+
PPT_SKG

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

test<-Raw_AgeClasses %>% filter(OrganismCode %in% "SKG")
test$Secchi
#Secchi Graph for SB 2011-2023
Secchi_SKG<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts. No effort \n accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 10)
  
Secchi_SKG

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT_SKG, DO_SKG, PPT_SKG, Secchi_SKG, ncol = 2, labels = "AUTO")
```

Doesnt seem important to parse out age classes. Check with big group for confirmation.

Note: put responses from different species in a grid for visual comparison.

### All together now

```{r}
plot_grid(WT_LFS, WT_ASH, WT_ISS, WT_SCP, WT_STBK, WT_SKG, ncol = 2, labels = "AUTO")

plot_grid(DO_LFS, DO_ASH, DO_ISS, DO_SCP, DO_STBK, DO_SKG, ncol = 2, labels = "AUTO")

plot_grid(PPT_LFS, PPT_ASH, PPT_ISS, PPT_SCP, PPT_STBK, PPT_SKG, ncol = 2, labels = "AUTO")

plot_grid(Secchi_LFS, Secchi_ASH, Secchi_ISS, Secchi_SCP, Secchi_STBK, Secchi_SKG, ncol = 2, labels = "AUTO")



```

### Stickleback had weird differences between normal and plus counted individuals. Want to investigate

First I will subset to trawl ids and sum rows for catch then divide by number of minutes spent trawling then join to environmental data.

```{r}
Stick<- Raw_AgeClasses %>% filter(CommonName == "Threespine Stickleback") %>% group_by(TrawlRowID) %>% summarize(StickleSum = sum(Count)) #Creating a table of stickleback catch which sums counts.
Sticks<-full_join(Stick, WaQua) #Automatically knows key
#now I need to replace the NAs with 0
Sticks <- Sticks %>% mutate(StickleSum = ifelse(is.na(StickleSum), 0, StickleSum), CatchPerMinute = StickleSum/TowDuration) #also adds a CPUE column

#Now plot
Sticks %>% ggplot()+geom_jitter(aes(DO, CatchPerMinute))+theme_bw()


WT_Stick<-Sticks %>% 
  ggplot(aes(x=WaterTemperature, y=CatchPerMinute))+ geom_point(alpha=0.5)+
  theme_bw()+ labs(y ="Catch per Minute Trawl", x="Water Temperature (C)", caption="Darker dots have overlapping points. Alpha = 0.5") 

WT_Stick 

DO_Stick<-Sticks %>% 
  ggplot(aes(x=DO, y=CatchPerMinute))+ geom_point(alpha=0.5)+
  theme_bw()+ labs(y ="Catch per Minute Trawl", x="DO (mg/L)", caption = "Darker dots have overlapping points. Alpha = 0.5") 

DO_Stick 
  
Salinity_Stick<-Sticks %>% 
  ggplot(aes(x=Salinity, y=CatchPerMinute))+ geom_point(alpha=0.5)+
  theme_bw()+ labs(y ="Catch per Minute Trawl", x="Salinity", caption = "Darker dots have overlapping points. Alpha = 0.5") 

Salinity_Stick 


Secchi_Stick<-Sticks %>% 
  ggplot(aes(x=Salinity, y=CatchPerMinute))+ geom_point(alpha=0.5)+
  theme_bw()+ labs(y ="Catch per Minute Trawl", x="Secchi (cm)", caption = "Darker dots have overlapping points. Alpha = 0.5") 

Secchi_Stick 

StickPlots<-plot_grid(WT_Stick, DO_Stick, Salinity_Stick, Secchi_Stick, ncol = 2, labels = "AUTO")

# now add the title
title <- ggdraw() + draw_label("Three-spined stickleback by water quality variables for SMFS 2011-2023", fontface = 'bold', x = 0, hjust = 0) +  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7))

plot_grid(title, StickPlots, ncol = 1,
  # rel_heights values control vertical title margins
  rel_heights = c(0.1, 1))

#Where are these fish caught?
Sticks %>% filter(!TrawlRowID%in%c("{CA55F407-453C-4827-B4FF-502469BA719B}","{C196AC37-0B72-4E75-B234-4677DE6193C0}","{70D120E5-241E-479A-82C5-CB74FB16A1D2}","{0DB41738-469A-421A-864A-0A9E82D2C4C6}","{4DCDE915-7D26-4DE5-8955-B157B41ABF97}","{19D692A3-82C8-46B7-BCC2-E97C48FAB747}","{3D3E4136-42D6-4B6D-BBF0-4B83E8E0CCD1}","{9E32B7B2-865E-4609-9807-EEC4661F02F8}","{DCA730D8-AFCA-4BCA-96E3-553BBFCD0246}","{0448E685-802D-4CB4-B86E-D8ADC921AF62}")) %>% #removing plus count trawls because they are outliers
  ggplot()+geom_violin(aes(x=StationCode, y=CatchPerMinute))

#Looking closer at plus counted fish
#I could just look at trawls with plus counted fish and see how long those trawls are, where they are, when they are?
PlusStickles<-Raw_AgeClasses %>% filter(CommonName == "Threespine Stickleback", StandardLength== 0)
#The plus counts of stickleback come from 10 trawls. 7 trawls in good year (which has duck ponds) for a total of 315 fish. 58 fish were caught in 1 trawl in boynton, 1 in 1 at Nurse, 6 in 1 at "TRDB2."

PlusStickles$TrawlRowID
```

## Seasonality

First need to convert date to day of year for simpler look at when species are present or not. I also want to make a dataframe that gives 0 or 1 for each day of year for each species across all years as well as for each year...

```{r}
Seasonal<-Raw_AgeClasses %>% mutate(DOY=yday(SampleDate)) #adds a column with day of year using yday from lubridate
Seasonal_All<-Seasonal %>% group_by(CommonName, DOY, Year) %>% summarize(Count=sum(Count)) %>% distinct() #Only have presence in the dataset. Add zeros for each sampling event... Do for species and then run code to see if accuracy improves..
Seasonal_All$Year<-as.factor(Seasonal_All$Year)
unique(Seasonal_All$CommonName)
```

### Longfin smelt

```{r}
l<-Seasonal_All %>% filter(CommonName == "Longfin Smelt") %>% ggplot(aes(x=DOY, y=Count)) + geom_col(aes(fill=Year)) +theme_bw()+ labs(title="Longfin smelt catch through years", caption = "Grouped by common name, day of year, and year to get sum of counts, geom_col filling color by year.")
l
l+facet_wrap(~Year)
```

### American shad

```{r}
a<-Seasonal_All %>% filter(CommonName == "American Shad") %>% ggplot(aes(x=DOY, y=Count)) + geom_col(aes(fill=Year)) +theme_bw()+ labs(title="American shad catch through years", caption = "Grouped by common name, day of year, and year to get sum of counts, geom_col filling color by year.")
a
a+facet_wrap(~Year)
```

### Inland Mississippi silverside

```{r}
I<-Seasonal_All %>% filter(CommonName == "Inland Silverside") %>% ggplot(aes(x=DOY, y=Count)) + geom_col(aes(fill=Year)) +theme_bw()+ labs(title="Inland Silverside catch through years", caption = "Grouped by common name, day of year, and year to get sum of counts, geom_col filling color by year.")
I
I+facet_wrap(~Year)
```

### Prickly Sculpin

```{r}
P<-Seasonal_All %>% filter(CommonName == "Prickly Sculpin") %>% ggplot(aes(x=DOY, y=Count)) + geom_col(aes(fill=Year)) +theme_bw()+ labs(title="Prickly Sculpin catch through years", caption = "Grouped by common name, day of year, and year to get sum of counts, geom_col filling color by year.")
P
P+facet_wrap(~Year)
```

### Three-spine stickleback

```{r}
Three<-Seasonal_All %>% filter(CommonName == "Threespine Stickleback") %>% ggplot(aes(x=DOY, y=Count)) + geom_col(aes(fill=Year)) +theme_bw()+ labs(title="Threespine Stickleback catch through years", caption = "Grouped by common name, day of year, and year to get sum of counts, geom_col filling color by year.")
Three
Three+facet_wrap(~Year)
```

### Shokihaze goby

```{r}
S<-Seasonal_All %>% filter(CommonName == "Shokihaze Goby") %>% ggplot(aes(x=DOY, y=Count)) + geom_col(aes(fill=Year)) +theme_bw()+ labs(title="Shokihaze Goby catch through years", caption = "Grouped by common name, day of year, and year to get sum of counts, geom_col filling color by year.")
S
S+facet_wrap(~Year)

Seasonal_All %>% filter(CommonName == "Shokihaze Goby") %>% ggplot(aes(x=DOY, y=Year, fill=Count)) + geom_tile()

```

Better to do heat map through years instead...

## Frequency Distribution Plots

I want to produce histograms/frequency distribution plots showing how data for species is represented over water quality, time, and demographics.

Species of interest: Threespine stickleback, striped bass, prickly sculpin, mississippi silversides, longfin smelt, shimofuri goby, american shad, yellowfin goby, threadfin shad, pacific staghorn sculpin, shokihazi goby, starry flounder.

```{r}
FishList<-unique(Raw_AgeClasses$OrganismCode)
FishList<- c("STBK", "SB", "SCP", "ISS", "LFS", "SG", "ASH", "YFG", "TFS", "STAG", "SF")
```

### Water Quality

```{r}
# Create a function to generate histograms
generate_histograms <- function(data, fish_species, variables) {
  data %>%
    filter(OrganismCode %in% fish_species) %>%
    gather(variable, value, all_of(variables)) %>%
    ggplot(aes(x = value, fill = variable)) +
    geom_histogram(binwidth = 1, position = "dodge", alpha = 0.5) +
    facet_wrap(~ variable, scales = "free") +
    labs(title = "Frequency Distribution of Count by Environmental Variable",
         x = "Value",
         y = "Frequency") +
    theme_minimal()
}

# Example usage of the function
generate_histograms(Raw_AgeClasses, FishList, c("WaterTemperature", "Salinity", "DO", "Secchi"))

# Create a function to generate separate sets of histograms for each fish species
generate_individual_histograms <- function(data, fish_species, variables) {
  for (species_code in fish_species) {
    data_subset <- data %>%
      filter(OrganismCode == species_code)
    
    if (nrow(data_subset) > 0) {
      p <- data_subset %>%
        gather(variable, value, all_of(variables)) %>%
        ggplot(aes(x = value, fill = variable)) +
        geom_histogram(binwidth = 1, position = "dodge", alpha = 0.5) +
        facet_wrap(~ variable, scales = "free") +
        labs(title = paste("Frequency Distribution for", species_code),
             x = "Value",
             y = "Frequency") +
        theme_minimal()
      
      print(p)
    }
  }
}

# Example usage of the function
generate_individual_histograms(Raw_AgeClasses, FishList, c("WaterTemperature", "Salinity", "DO", "Secchi"))


generate_individual_bar_plots <- function(data, fish_species, variables) {
  for (species_code in fish_species) {
    data_subset <- data %>%
      filter(OrganismCode == species_code)
    
    if (nrow(data_subset) > 0) {
      p <- data_subset %>%
        gather(variable, value, all_of(variables)) %>%
        group_by(variable, value) %>%
        summarise(sum_Count = sum(Count, na.rm = TRUE)) %>%
        ggplot(aes(x = value, y = sum_Count, fill = variable)) +
        geom_col(width=1) +
        facet_wrap(~ variable, scales = "free") +
        labs(title = paste("Count Distribution for", species_code),
             x = "Value",
             y = "Total Count") +  
        theme_minimal()
      
      print(p)
    }
  }
}

# Example usage of the function
generate_individual_bar_plots(Raw_AgeClasses, FishList, c("WaterTemperature", "Salinity", "DO", "Secchi"))


#facet_grid
WaterFacet<-Raw_AgeClasses %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = WaterTemperature, y = Count)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal()

SecchiFacet<-Raw_AgeClasses %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = Secchi, y = Count)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal()

DOFacet<-Raw_AgeClasses %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = DO, y = Count)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal()

SalinityFacet<-Raw_AgeClasses %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = Salinity, y = Count)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal()
```

### Temporal

```{r}
YearFacet<-Raw_AgeClasses %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = Year, y = Count)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal() + theme(axis.text.x = element_text(angle=45))

MonthFacet<-Raw_AgeClasses %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = Month, y = Count)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal() #+ theme(axis.text.x = element_text(angle=45))

SizeFacet<-Raw_AgeClasses %>% filter(OrganismCode %in% FishList & StandardLength>0) %>% 
        ggplot(aes(x = Month, y = Count)) +
        geom_col(width=1) +
        facet_grid(Year~OrganismCode) +
        theme_minimal() 
```

### Demographics

```{r Demographics}
SizeFacet<-Raw_AgeClasses %>% filter(OrganismCode %in% FishList & StandardLength>0) %>% 
        ggplot(aes(x = StandardLength, y = Count)) +
        geom_col(width=1) +
        facet_grid(Month~OrganismCode, scales = "free") +
        theme_minimal() + xlab("Standard Length (mm)")
```

## Other plots

```{r}
Raw_AgeClasses %>% 
  filter(OrganismCode %in% "TP") %>% 
  ggplot(aes(x = WaterTemperature, y = Count)) +
  geom_col(position = "dodge") +
  labs(x = "Water Temp", y = "Catch Frequency", title = "Tule Perch Catch Frequency by Water Temp") +
  theme_minimal() 

```

```{r}

CatchFrequency <- function(data, x, y, title) {
  ggplot(data) +
    aes({{x}}, {{y}}) +
    geom_col(position = "dodge") +
    labs(x = deparse(substitute(x)), y = deparse(substitute(y)), title = title) +
    theme_minimal()
} #deparse automatically pulls the name from x and y to label the axes. This function is to make plotting more streamlined :)

#Water Temp graph for TP 2011-2023
WT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "TP", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "TP & Water Temp SMFS 2011-2023")
#DO Graph for TP  2011-2023
DO.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "TP", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "TP & DO SMFS 2011-2023")
#Salinity Graph for TP 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "TP", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "TP & Salinity SMFS 2011-2023")
#Secchi Graph for TP 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "TP", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "TP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Striped Bass 2011-2023
WT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SB", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "SB & Water Temp SMFS 2011-2023")
#DO Graph for SB  2011-2023
DO.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SB", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "SB & DO SMFS 2011-2023")
#Salinity Graph for SB 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SB", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "SB & Salinity SMFS 2011-2023")
#Secchi Graph for SB 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SB", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "SB & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Prickly Sculpin 2011-2023
WT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SCP", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "SCP & Water Temp SMFS 2011-2023")
#DO Graph for SCP  2011-2023
DO.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SCP", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "SCP & DO SMFS 2011-2023")
#Salinity Graph for SCP 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SCP", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "SCP & Salinity SMFS 2011-2023")
#Secchi Graph for SCP 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SCP", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "SCP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Longfin Smelt 2011-2023
WT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "LFS", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "LFS & Water Temp SMFS 2011-2023")
#DO Graph for LFS  2011-2023
DO.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "LFS", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "LFS & DO SMFS 2011-2023")
#Salinity Graph for LFS 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "LFS", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "LFS & Salinity SMFS 2011-2023")
#Secchi Graph for LFS 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "LFS", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "LFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Yellowfin Goby 2011-2023
WT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "YFG", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "YFG & Water Temp SMFS 2011-2023")
#DO Graph for YFG  2011-2023
DO.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "YFG", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "YFG & DO SMFS 2011-2023")
#Salinity Graph for YFG 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "YFG", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "YFG & Salinity SMFS 2011-2023")
#Secchi Graph for YFG 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "YFG", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "YFG & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for American Shad 2011-2023
WT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ASH", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "ASH & Water Temp SMFS 2011-2023")
#DO Graph for ASH  2011-2023
DO.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ASH", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "ASH & DO SMFS 2011-2023")
#Salinity Graph for ASH 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ASH", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "ASH & Salinity SMFS 2011-2023")
#Secchi Graph for ASH 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ASH", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "ASH & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Threadfin Shad 2011-2023
WT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "TFS", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "TFS & Water Temp SMFS 2011-2023")
#DO Graph for TFS  2011-2023
DO.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "TFS", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "TFS & DO SMFS 2011-2023")
#Salinity Graph for TFS 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "TFS", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "TFS & Salinity SMFS 2011-2023")
#Secchi Graph for TFS 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "TFS", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "TFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Starry Flounder 2011-2023
WT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SF", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "SF & Water Temp SMFS 2011-2023")
#DO Graph for SF  2011-2023
DO.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SF", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "SF & DO SMFS 2011-2023")
#Salinity Graph for SF 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SF", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "SF & Salinity SMFS 2011-2023")
#Secchi Graph for SF 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SF", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "SF & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")


```

```{r, eval=FALSE, echo=FALSE}


#Lets plot WaterTemp Count now
# Step 1: Sum count over each unique sample row ID
summed_data <- Raw_AgeClasses %>%
  group_by(SampleRowID, OrganismCode, WaterTemperature) %>%
  summarize(SumCount = sum(Count),
            n=n(SampleRowID),
            Count = SumCount/n())

# Step 2: Calculate catch per unit effort
#I want Count for each water quality parameter

#Count = catch per 5 minute trawl (filter out durations outside of norm) (so could split 10 min trawl catch in half or calculate them separately). For now. 
#Use SampleRowID as unique trawls. Columns: SampleRowID, Metadata, OrganismCode, Count (size will come later), Site.

Count_5min_Temp <- Raw_AgeClasses %>% filter(TowDuration == 5) %>% group_by(WaterTemperature, OrganismCode) %>% summarize(Count = sum(Count)/n(), n = n(), Count = Count)

Count_10min_Temp <- Raw_AgeClasses %>% filter(TowDuration == 10) %>% group_by(WaterTemperature, OrganismCode) %>% summarize(Count = sum(Count)/n(), n = n(), Count = Count)


#Lets run a check real quick
#Removing NAs from Tow Duration since we won't have Count from them
Raw_AgeClasses_NoTowNA<-Raw_AgeClasses %>% filter(!is.na(TowDuration)) #333872

Five<-Raw_AgeClasses_NoTowNA %>% filter(TowDuration == 5) #237628, so matches the Count calculation
Ten<-Raw_AgeClasses_NoTowNA %>% filter(TowDuration == 10) #93027, matches Count calculation
Other<-Raw_AgeClasses_NoTowNA %>% filter(TowDuration != 5, 
                                                    TowDuration != 10) #3217
3217+237628+93027 #checks out!

Count_5min_DO <- Raw_AgeClasses %>% filter(TowDuration == 5) %>% group_by(DO, OrganismCode) %>% summarize(Count = sum(Count)/n(), n = n(), Count = Count)

Count_10min_DO <- Raw_AgeClasses %>% filter(TowDuration == 10) %>% group_by(DO, OrganismCode) %>% summarize(Count = sum(Count)/n(), n = n(), Count = Count)

Count_5min_PPT <- Raw_AgeClasses %>% filter(TowDuration == 5) %>% group_by(Salinity, OrganismCode) %>% summarize(Count = sum(Count)/n(), n = n(), Count = Count)

Count_10min_PPT <- Raw_AgeClasses %>% filter(TowDuration == 10) %>% group_by(Salinity, OrganismCode) %>% summarize(Count = sum(Count)/n(), n = n(), Count = Count)

Count_5min_Secchi <- Raw_AgeClasses %>% filter(TowDuration == 5) %>% group_by(Secchi, OrganismCode) %>% summarize(Count = sum(Count)/n(), n = n(), Count = Count)

Count_10min_Secchi <- Raw_AgeClasses %>% filter(TowDuration == 10) %>% group_by(Secchi, OrganismCode) %>% summarize(Count = sum(Count)/n(), n = n(), Count = Count)

#Plot Count Now
CatchFrequency <- function(data, x, y, title) {
  ggplot(data) +
    aes({{x}}, {{y}}) +
    geom_col(position = "dodge") +
    labs(x = deparse(substitute(x)), y = deparse(substitute(y)), title = title) +
    theme_minimal() + scale_x_continuous(breaks = seq(0, 1000, 5)) + scale_y_continuous(breaks = seq(0, 50, 1))
}
#Water Temp graph for TP 2011-2023
WT.Plot<-Count_5min_Temp %>% 
  filter(OrganismCode %in% "TP", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "5 min Trawl Catch per Trawl of TP & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for TP  2011-2023
DO.Plot<-Count_5min_DO %>% 
  filter(OrganismCode %in% "TP", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "5 min Trawl Catch per Trawl of TP & DO SMFS 2011-2023")
#Salinity Graph for TP 2011-2023
PPT.Plot<-Count_5min_PPT %>% 
  filter(OrganismCode %in% "TP", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "5 min Trawl Catch per Trawl of TP & Salinity SMFS 2011-2023")
#Secchi Graph for TP 2011-2023
Secchi.Plot<-Count_5min_Secchi %>% 
  filter(OrganismCode %in% "TP", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "5 min Trawl Catch per Trawl of TP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for TP 2011-2023
WT.Plot<-Count_10min_Temp %>% 
  filter(OrganismCode %in% "TP", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "10 min Trawl Catch per Trawl of TP & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for TP  2011-2023
DO.Plot<-Count_10min_DO %>% 
  filter(OrganismCode %in% "TP", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "10 min Trawl Catch per Trawl of TP & DO SMFS 2011-2023")
#Salinity Graph for TP 2011-2023
PPT.Plot<-Count_10min_PPT %>% 
  filter(OrganismCode %in% "TP", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "10 min Trawl Catch per Trawl of TP & Salinity SMFS 2011-2023")
#Secchi Graph for TP 2011-2023
Secchi.Plot<-Count_10min_Secchi %>% 
  filter(OrganismCode %in% "TP", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "10 min Trawl Catch per Trawl of TP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")




#Water Temp Count graph for SB 2011-2023
WT.Plot<-Count_5min_Temp %>% 
  filter(OrganismCode %in% "SB", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "5 min Trawl Catch per Trawl of SB & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SB  2011-2023
DO.Plot<-Count_5min_DO %>% 
  filter(OrganismCode %in% "SB", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "5 min Trawl Catch per Trawl of SB & DO SMFS 2011-2023")
#Salinity Graph for SB 2011-2023
PPT.Plot<-Count_5min_PPT %>% 
  filter(OrganismCode %in% "SB", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "5 min Trawl Catch per Trawl of SB & Salinity SMFS 2011-2023")
#Secchi Graph for SB 2011-2023
Secchi.Plot<-Count_5min_Secchi %>% 
  filter(OrganismCode %in% "SB", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "5 min Trawl Catch per Trawl of SB & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for SB 2011-2023
WT.Plot<-Count_10min_Temp %>% 
  filter(OrganismCode %in% "SB", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "10 min Trawl Catch per Trawl of SB & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SB  2011-2023
DO.Plot<-Count_10min_DO %>% 
  filter(OrganismCode %in% "SB", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "10 min Trawl Catch per Trawl of SB & DO SMFS 2011-2023")
#Salinity Graph for SB 2011-2023
PPT.Plot<-Count_10min_PPT %>% 
  filter(OrganismCode %in% "SB", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "10 min Trawl Catch per Trawl of SB & Salinity SMFS 2011-2023")
#Secchi Graph for SB 2011-2023
Secchi.Plot<-Count_10min_Secchi %>% 
  filter(OrganismCode %in% "SB", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "10 min Trawl Catch per Trawl of SB & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")






#Water Temp Count graph for SCP 2011-2023
WT.Plot<-Count_5min_Temp %>% 
  filter(OrganismCode %in% "SCP", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "5 min Trawl Catch per Trawl of SCP & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SCP  2011-2023
DO.Plot<-Count_5min_DO %>% 
  filter(OrganismCode %in% "SCP", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "5 min Trawl Catch per Trawl of SCP & DO SMFS 2011-2023")
#Salinity Graph for SCP 2011-2023
PPT.Plot<-Count_5min_PPT %>% 
  filter(OrganismCode %in% "SCP", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "5 min Trawl Catch per Trawl of SCP & Salinity SMFS 2011-2023")
#Secchi Graph for SCP 2011-2023
Secchi.Plot<-Count_5min_Secchi %>% 
  filter(OrganismCode %in% "SCP", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "5 min Trawl Catch per Trawl of SCP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for SCP 2011-2023
WT.Plot<-Count_10min_Temp %>% 
  filter(OrganismCode %in% "SCP", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "10 min Trawl Catch per Trawl of SCP & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SCP  2011-2023
DO.Plot<-Count_10min_DO %>% 
  filter(OrganismCode %in% "SCP", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "10 min Trawl Catch per Trawl of SCP & DO SMFS 2011-2023")
#Salinity Graph for SCP 2011-2023
PPT.Plot<-Count_10min_PPT %>% 
  filter(OrganismCode %in% "SCP", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "10 min Trawl Catch per Trawl of SCP & Salinity SMFS 2011-2023")
#Secchi Graph for SCP 2011-2023
Secchi.Plot<-Count_10min_Secchi %>% 
  filter(OrganismCode %in% "SCP", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "10 min Trawl Catch per Trawl of SCP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")







#Water Temp Count graph for LFS 2011-2023
WT.Plot<-Count_5min_Temp %>% 
  filter(OrganismCode %in% "LFS", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "5 min Trawl Catch per Trawl of LFS & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for LFS  2011-2023
DO.Plot<-Count_5min_DO %>% 
  filter(OrganismCode %in% "LFS", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "5 min Trawl Catch per Trawl of LFS & DO SMFS 2011-2023")
#Salinity Graph for LFS 2011-2023
PPT.Plot<-Count_5min_PPT %>% 
  filter(OrganismCode %in% "LFS", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "5 min Trawl Catch per Trawl of LFS & Salinity SMFS 2011-2023")
#Secchi Graph for LFS 2011-2023
Secchi.Plot<-Count_5min_Secchi %>% 
  filter(OrganismCode %in% "LFS", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "5 min Trawl Catch per Trawl of LFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for LFS 2011-2023
WT.Plot<-Count_10min_Temp %>% 
  filter(OrganismCode %in% "LFS", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "10 min Trawl Catch per Trawl of LFS & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for LFS  2011-2023
DO.Plot<-Count_10min_DO %>% 
  filter(OrganismCode %in% "LFS", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "10 min Trawl Catch per Trawl of LFS & DO SMFS 2011-2023")
#Salinity Graph for LFS 2011-2023
PPT.Plot<-Count_10min_PPT %>% 
  filter(OrganismCode %in% "LFS", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "10 min Trawl Catch per Trawl of LFS & Salinity SMFS 2011-2023")
#Secchi Graph for LFS 2011-2023
Secchi.Plot<-Count_10min_Secchi %>% 
  filter(OrganismCode %in% "LFS", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "10 min Trawl Catch per Trawl of LFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")












#Water Temp Count graph for YFG 2011-2023
WT.Plot<-Count_5min_Temp %>% 
  filter(OrganismCode %in% "YFG", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "5 min Trawl Catch per Trawl of YFG & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for YFG  2011-2023
DO.Plot<-Count_5min_DO %>% 
  filter(OrganismCode %in% "YFG", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "5 min Trawl Catch per Trawl of YFG & DO SMFS 2011-2023")
#Salinity Graph for YFG 2011-2023
PPT.Plot<-Count_5min_PPT %>% 
  filter(OrganismCode %in% "YFG", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "5 min Trawl Catch per Trawl of YFG & Salinity SMFS 2011-2023")
#Secchi Graph for YFG 2011-2023
Secchi.Plot<-Count_5min_Secchi %>% 
  filter(OrganismCode %in% "YFG", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "5 min Trawl Catch per Trawl of YFG & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for YFG 2011-2023
WT.Plot<-Count_10min_Temp %>% 
  filter(OrganismCode %in% "YFG", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "10 min Trawl Catch per Trawl of YFG & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for YFG  2011-2023
DO.Plot<-Count_10min_DO %>% 
  filter(OrganismCode %in% "YFG", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "10 min Trawl Catch per Trawl of YFG & DO SMFS 2011-2023")
#Salinity Graph for YFG 2011-2023
PPT.Plot<-Count_10min_PPT %>% 
  filter(OrganismCode %in% "YFG", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "10 min Trawl Catch per Trawl of YFG & Salinity SMFS 2011-2023")
#Secchi Graph for YFG 2011-2023
Secchi.Plot<-Count_10min_Secchi %>% 
  filter(OrganismCode %in% "YFG", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "10 min Trawl Catch per Trawl of YFG & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")









#Water Temp Count graph for ASH 2011-2023
WT.Plot<-Count_5min_Temp %>% 
  filter(OrganismCode %in% "ASH", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "5 min Trawl Catch per Trawl of ASH & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for ASH  2011-2023
DO.Plot<-Count_5min_DO %>% 
  filter(OrganismCode %in% "ASH", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "5 min Trawl Catch per Trawl of ASH & DO SMFS 2011-2023")
#Salinity Graph for ASH 2011-2023
PPT.Plot<-Count_5min_PPT %>% 
  filter(OrganismCode %in% "ASH", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "5 min Trawl Catch per Trawl of ASH & Salinity SMFS 2011-2023")
#Secchi Graph for ASH 2011-2023
Secchi.Plot<-Count_5min_Secchi %>% 
  filter(OrganismCode %in% "ASH", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "5 min Trawl Catch per Trawl of ASH & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for ASH 2011-2023
WT.Plot<-Count_10min_Temp %>% 
  filter(OrganismCode %in% "ASH", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "10 min Trawl Catch per Trawl of ASH & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for ASH  2011-2023
DO.Plot<-Count_10min_DO %>% 
  filter(OrganismCode %in% "ASH", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "10 min Trawl Catch per Trawl of ASH & DO SMFS 2011-2023")
#Salinity Graph for ASH 2011-2023
PPT.Plot<-Count_10min_PPT %>% 
  filter(OrganismCode %in% "ASH", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "10 min Trawl Catch per Trawl of ASH & Salinity SMFS 2011-2023")
#Secchi Graph for ASH 2011-2023
Secchi.Plot<-Count_10min_Secchi %>% 
  filter(OrganismCode %in% "ASH", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "10 min Trawl Catch per Trawl of ASH & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

NoNASecchi<-Raw_AgeClasses_NoTowNA %>% filter(!is.na(Secchi))
range(NoNASecchi$Secchi) #Max secchi is 99! Catches over 99 are unmeasurable (possibly written as 99?) since we only bring out a meter stick.











#Water Temp Count graph for TFS 2011-2023
WT.Plot<-Count_5min_Temp %>% 
  filter(OrganismCode %in% "TFS", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "5 min Trawl Catch per Trawl of TFS & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for TFS  2011-2023
DO.Plot<-Count_5min_DO %>% 
  filter(OrganismCode %in% "TFS", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "5 min Trawl Catch per Trawl of TFS & DO SMFS 2011-2023")
#Salinity Graph for TFS 2011-2023
PPT.Plot<-Count_5min_PPT %>% 
  filter(OrganismCode %in% "TFS", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "5 min Trawl Catch per Trawl of TFS & Salinity SMFS 2011-2023")
#Secchi Graph for TFS 2011-2023
Secchi.Plot<-Count_5min_Secchi %>% 
  filter(OrganismCode %in% "TFS", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "5 min Trawl Catch per Trawl of TFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for TFS 2011-2023
WT.Plot<-Count_10min_Temp %>% 
  filter(OrganismCode %in% "TFS", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "10 min Trawl Catch per Trawl of TFS & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for TFS  2011-2023
DO.Plot<-Count_10min_DO %>% 
  filter(OrganismCode %in% "TFS", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "10 min Trawl Catch per Trawl of TFS & DO SMFS 2011-2023")
#Salinity Graph for TFS 2011-2023
PPT.Plot<-Count_10min_PPT %>% 
  filter(OrganismCode %in% "TFS", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "10 min Trawl Catch per Trawl of TFS & Salinity SMFS 2011-2023")
#Secchi Graph for TFS 2011-2023
Secchi.Plot<-Count_10min_Secchi %>% 
  filter(OrganismCode %in% "TFS", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "10 min Trawl Catch per Trawl of TFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")











#Water Temp Count graph for SF 2011-2023
WT.Plot<-Count_5min_Temp %>% 
  filter(OrganismCode %in% "SF", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "5 min Trawl Catch per Trawl of SF & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SF  2011-2023
DO.Plot<-Count_5min_DO %>% 
  filter(OrganismCode %in% "SF", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "5 min Trawl Catch per Trawl of SF & DO SMFS 2011-2023")
#Salinity Graph for SF 2011-2023
PPT.Plot<-Count_5min_PPT %>% 
  filter(OrganismCode %in% "SF", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "5 min Trawl Catch per Trawl of SF & Salinity SMFS 2011-2023")
#Secchi Graph for SF 2011-2023
Secchi.Plot<-Count_5min_Secchi %>% 
  filter(OrganismCode %in% "SF", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "5 min Trawl Catch per Trawl of SF & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for SF 2011-2023
WT.Plot<-Count_10min_Temp %>% 
  filter(OrganismCode %in% "SF", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, Count, title = "10 min Trawl Catch per Trawl of SF & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SF  2011-2023
DO.Plot<-Count_10min_DO %>% 
  filter(OrganismCode %in% "SF", !is.na(DO)) %>%
  CatchFrequency(DO, Count, title = "10 min Trawl Catch per Trawl of SF & DO SMFS 2011-2023")
#Salinity Graph for SF 2011-2023
PPT.Plot<-Count_10min_PPT %>% 
  filter(OrganismCode %in% "SF", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, Count, title = "10 min Trawl Catch per Trawl of SF & Salinity SMFS 2011-2023")
#Secchi Graph for SF 2011-2023
Secchi.Plot<-Count_10min_Secchi %>% 
  filter(OrganismCode %in% "SF", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, Count, title = "10 min Trawl Catch per Trawl of SF & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#NEXT: Bin original dataframe (fewer rows but higher counts, column with Species_BinSize and do complete on that.)
glimpse(Raw_AgeClasses)
glimpse(SMFS_AgesBySizeMo)

#Need to do this before adding zeros. New script!

```
