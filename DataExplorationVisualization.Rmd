---
title: "Data Exploration & Visualization"
author: "Caroline Newell"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Load Libraries
library(tidyverse)
library(readr)
library(readxl)
library(cowplot)
library(lubridate)
library(fuzzyjoin)
```

# Visuals of Raw Data
I know we are not planning to use "age classes" as they are possibly incorrect but it is a useful measure of size differences. I know they are referred to here as "age classes" but it is similar to refer to them as size classes.

## Load Data and Wrangle

```{r}
SMFS_Thesis <- read_csv("Data/SMFS_Thesis.csv") #this dataset includes all SMFS OT data from 2011-2023 data 

#I'm leaving the NA water quality in for now. 
#Need to merge with ages. Will move this to data wrangling after plus counts are dealt with.
SMFS_AgesBySizeMo <- read_excel("Data/SMFS_AgesBySizeMo.xlsx")
#Need to update the max in the csv for sizes for HCH to 266 in Jan, BF to 450 in Oct, and ASH to 460 in Aug
SMFS_AgesBySizeMo<-SMFS_AgesBySizeMo %>% mutate(Max = case_when(OrganismCode == "HCH" & Month == 1 ~ 267,
                          OrganismCode == "BF" & Month == 10  ~ 451,
                          OrganismCode == "ASH" & Class == "Age-1+" & Month == 8  ~ 461, TRUE~Max)) #This code ups the maxes for the 3 fish previously being deleted.

#ggplot(SMFS_AgesBySizeMo, aes(x=Month, color=Class))+
 # geom_linerange(ymin=SMFS_AgesBySizeMo$Min, ymax=SMFS_AgesBySizeMo$Max)+
 # facet_wrap(~OrganismCode) #I want to double check these are right with no overlap by plotting them but it is hard :(

#filtering out to general fish of interest
Raw<-SMFS_Thesis %>% filter(OrganismCode%in%c("LFS", "SB", "TP", "STAG", "SF", "CP", "DS", "ISS", "WCF", "TFS", "ST", "STBK", "SCP", "SKR", "BF", "BLB", "CCF", "CS", "HCH", "MQF", "NAC", "PH", "RWK", "SPM", "WAK", "WC", "WS", "YFG", "ASH", "SG", "SKG", "BC", "GF")) #Filtering out just fish that we have age class info for...

#filter out instances where there is 0 standard length, I'll rbind them back later.
PlusCounts<-Raw %>% filter(StandardLength==0)
Raws_AgeClass<-Raw %>% filter(StandardLength!=0)

#before I add age class, I have to rename a duplicated column name "class"
AgesBySizeMo<-SMFS_AgesBySizeMo %>% rename("AgeClass"="Class")
#adding age class info
Raw_AgeClass<- left_join(Raws_AgeClass, AgesBySizeMo, join_by("OrganismCode", "Month"))#left join because I don't want age classes for fish we did not catch.
glimpse(Raw_AgeClass) #148,341 rows, 52 columns.

# Create a boolean condition based on the size range
condition <- between(Raw_AgeClass$StandardLength, Raw_AgeClass$Min, Raw_AgeClass$Max)

# Update the 'Class' column in 'Raw_AgeClass'
Raw_AgeClass$AgeClass <- ifelse(condition, Raw_AgeClass$AgeClass, "Delete") #Keeping age class assignments if condition is met, otherwise assigning "delete" value to the row.
unique(Raw_AgeClass$AgeClass)

Raw_AgeClass <- filter(Raw_AgeClass, AgeClass != "Delete") #deleting the rows that did not match the condition
unique(Raw_AgeClass$AgeClass)
glimpse(Raw_AgeClass) #58,320 rows

#Now adding plus counts back in
PlusCounts<-PlusCounts %>% mutate(Min = NA, Max = NA, AgeClass = "PLUS")
Raw_AgeClasses<-rbind(Raw_AgeClass, PlusCounts)

glimpse(Raw) #58,638 rows and 49 columns before adding age class information. Number of rows should match Raw_AgeClasses output.

glimpse(Raws_AgeClass)#58,313 rows after removing plus counts (length of 0).

glimpse(Raw_AgeClass) #149,168 rows and 52 columns after removing plus counts and joining data with age classes. I get every possible age class here for each fish.

glimpse(PlusCounts)#325 rows and 52 columns of plus counts.

str(Raw_AgeClasses) #58,638 rows and 52 columns of measured fish with plus count fish. Why did I gain 9 rows? I think there is a problem with the age class table - overlapping min/max perhaps?

#WOO! DEBUGGED!

```

## Catch of lengths for each water quality by year

Species of interest: LFS, ASH, ISS, SCP, STBK, SKG

If we see different age classes popping up in different areas of wq (for instance most age 1 to the left, age 2 to the right, we may expect differences in sensitivity to water quality by age). If there is a lot of overlap with no clear segregation across years I imagine that means there isn't substantial support for modelling the ages separately. 

*NOTE: These plots are only for visual assessment of age class differences in responses to water quality variables. No effort represented in these plots.*

### Longfin Smelt
```{r}
test<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) #Adds new column that round water temperature to nearest 0.5
test$water_temp_bin

#Water Temp graph for 2011-2023
WT<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & Dissolved Oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) #+facet_wrap(~AgeClass, scales="free_y")
DO
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)
  #facet_wrap(~Year)+
PPT.Plot

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

summary(Raw_AgeClasses$Secchi)
#Secchi Graph for SB 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20)
  
Secchi.Plot

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "LFS", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Longfin smelt age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT, DO, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")
```



### American Shad
```{r}

WT<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) #+facet_wrap(~AgeClass, scales="free_y")
DO
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)
  #facet_wrap(~Year)+
PPT.Plot

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

summary(Raw_AgeClasses$Secchi)
#Secchi Graph for SB 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts. No effort \n accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20)
  
Secchi.Plot

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ASH", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "American shad age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT, DO, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")
```
 
### ISS
```{r}

WT<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) #+facet_wrap(~AgeClass, scales="free_y")
DO
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)
  #facet_wrap(~Year)+
PPT.Plot

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 8)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

test<-Raw_AgeClasses %>% filter(OrganismCode %in% "ISS")
test$Secchi
#Secchi Graph for SB 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts. No effort \n accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 10)
  
Secchi.Plot

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "ISS", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Miss. silverside age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT, DO, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")
```

### SCP
```{r}

WT<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) #+facet_wrap(~AgeClass, scales="free_y")
DO
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)
  #facet_wrap(~Year)+
PPT.Plot

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

test<-Raw_AgeClasses %>% filter(OrganismCode %in% "SCP")
test$Secchi
#Secchi Graph for SB 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts. No effort \n accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 10)
  
Secchi.Plot

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SCP", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Prickly sculpin age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT, DO, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")
```

### STBK
```{r}

WT<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback\n age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) #+facet_wrap(~AgeClass, scales="free_y")
DO
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)
  #facet_wrap(~Year)+
PPT.Plot

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

test<-Raw_AgeClasses %>% filter(OrganismCode %in% "STBK")
test$Secchi
#Secchi Graph for SB 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts. No effort \n accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 10)
  
Secchi.Plot

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "STBK", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Three-spined stickleback \n age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT, DO, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")
```

### SKG
```{r}

WT<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby\n age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature\n to get sum of counts. No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) #+facet_wrap(~AgeClass, scales="free_y")
WT #Displays catch as calculated for each unique combination of age class and water quality value. 

WT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(water_temp_bin = round(WaterTemperature * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(water_temp_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=water_temp_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & water temperature SMFS 2011-2023", y ="Summed Catch", x="Water Temperature (C)", caption = "Water temperatures rounded to 0.5 then grouped by age class and water temperature to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 20) + facet_wrap(~Year)

WT.Year.Plot

#DO Graph for SB  2011-20

DO<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) #+facet_wrap(~AgeClass, scales="free_y")
DO
  

DO.Year.Plot<-Raw_AgeClasses %>% 
  mutate(DO_bin = round(DO * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(DO_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=DO_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & dissolved oxygen SMFS 2011-2023", y ="Summed Catch", x="DO (mg/L)", caption = "Dissolved oxygen rounded to 0.5 then grouped by age class and DO to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 12) + facet_wrap(~Year)

DO.Year.Plot

summary(Raw_AgeClasses$Salinity)
#Salinity Graph for SB 2011-2023
PPT.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)
  #facet_wrap(~Year)+
PPT.Plot

PPT.Year.Plot<-Raw_AgeClasses %>% 
  mutate(Sal_bin = round(Salinity * 2) / 2) %>%
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(Sal_bin, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Sal_bin, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & salinity SMFS 2011-2023", y ="Summed Catch", x="Salinity", caption = "Salinity rounded to 0.5 then grouped by age class and salinity to get sum of counts.\n No effort accounted for in the data represented.") + 
  scale_x_continuous(n.breaks = 15)+facet_wrap(~Year)
  #facet_wrap(~Year)+
PPT.Year.Plot

test<-Raw_AgeClasses %>% filter(OrganismCode %in% "SKG")
test$Secchi
#Secchi Graph for SB 2011-2023
Secchi.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts. No effort \n accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 10)
  
Secchi.Plot

Secchi.Year.Plot<-Raw_AgeClasses %>% 
  filter(OrganismCode %in% "SKG", !is.na(Count)) %>% 
  group_by(Secchi, AgeClass, Year) %>% 
  summarize(Catch=sum(Count), Tow=sum(TowDuration))  %>% 
  ggplot(aes(x=Secchi, y=Catch))+
  geom_line(aes(color=AgeClass))+ 
  theme_bw()+ labs(title = "Shokihaze goby \n age classes & secchi (cm) SMFS 2011-2023", y ="Summed Catch", x="Secchi (cm)", caption = "Grouped by age class and secchi to get sum of counts.\n No effort accounted for in the data represented. Water is more clear at higher secchi readings.") + 
  scale_x_continuous(n.breaks = 20) +
  facet_wrap(~Year)
  
Secchi.Year.Plot


# Arrange plots into a single image
plot_grid(WT, DO, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")
```


## Matching Levi's Alviso Dynamics Plot
I want to make Levi's plots!
I need a three by four grid of boxplots as follows: 
By year    By Month   By Site

DO (%sat)
Sal (psu)
Temp (degC)
SEC (cm)
## SMFS Dynamics
```{r}
SMFS_Thesis$Year<-as.factor(SMFS_Thesis$Year)
SMFS_Thesis$Month<-as.factor(SMFS_Thesis$Month)
#need cowplot
Year_DO<-SMFS_Thesis %>% ggplot(aes(x=Year, y=PctSaturation))+geom_boxplot(fill="grey")+ylab("DO (%sat)")+theme_bw() +                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Year_Sal<-SMFS_Thesis %>% ggplot(aes(x=Year, y=Salinity))+geom_boxplot(fill="grey")+ylab("SAL (ppt)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Year_Temp<-SMFS_Thesis %>% ggplot(aes(x=Year, y=WaterTemperature))+geom_boxplot(fill="grey")+ylab("TEMP (degC)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Year_SEC<- SMFS_Thesis %>% ggplot(aes(x=Year, y=Secchi))+geom_boxplot(fill="grey")+ylab("SEC (cm)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")

Month_DO<-SMFS_Thesis %>% ggplot(aes(x=Month, y=PctSaturation))+geom_boxplot(fill="grey")+ylab("DO (%sat)")+theme_bw() +                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Month_Sal<-SMFS_Thesis %>% ggplot(aes(x=Month, y=Salinity))+geom_boxplot(fill="grey")+ylab("SAL (ppt)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Month_Temp<-SMFS_Thesis %>% ggplot(aes(x=Month, y=WaterTemperature))+geom_boxplot(fill="grey")+ylab("TEMP (degC)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
Month_SEC<- SMFS_Thesis %>% ggplot(aes(x=Month, y=Secchi))+geom_boxplot(fill="grey")+ylab("SEC (cm)")+theme_bw()+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
sort(unique(SMFS_Thesis$StationCode)) #gives list in alphabetical order!
StationCode_DO<-SMFS_Thesis %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>%  ggplot(aes(x=StationCode, y=PctSaturation))+geom_boxplot(fill="grey")+ylab("DO (%sat)")+theme_bw() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
StationCode_Sal<-SMFS_Thesis %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>% ggplot(aes(x=StationCode, y=Salinity))+geom_boxplot(fill="grey")+ylab("SAL (ppt)")+theme_bw()+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
StationCode_Temp<-SMFS_Thesis %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>% ggplot(aes(x=StationCode, y=WaterTemperature))+geom_boxplot(fill="grey")+ylab("TEMP (degC)")+theme_bw()+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")
StationCode_SEC<- SMFS_Thesis %>% filter(StationCode %in% c("BY1", "BY2", "CO1", "CO2", "DV1", "DV2", "DV3", "GY1", "GY2", "GY3", "MZ1", "MZ2","MZ6",    "MZN3", "NS1", "NS2", "NS3", "PT1",  "PT2",  "PT3",  "SB1", "SB2", "SD2",    "SU1", "SU2", "SU3", "SU4")) %>% ggplot(aes(x=StationCode, y=Secchi))+geom_boxplot(fill="grey")+ylab("SEC (cm)")+theme_bw() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+                      # Add median line to boxplot
  stat_summary(fun = median,
               geom = "line",
               aes(group = 1),
               col = "red")

plot_grid(Year_DO, Month_DO, StationCode_DO, Year_Sal, Month_Sal, StationCode_Sal, Year_Temp, Month_Temp, StationCode_Temp, Year_SEC, Month_SEC, StationCode_SEC, nrow=4) #wait could I do this with facet wraps??? facet_grid? No, because each plot has different x,y combo... 

#Make y-axis match levi's
```


## Frequency Distribution Plots
I want to produce histograms/frequency distribution plots showing how data for species is represented over water quality, time, and demographics.

Species of interest: Threespine stickleback, striped bass, prickly sculpin, mississippi silversides, longfin smelt, shimofuri goby, american shad, yellowfin goby, threadfin shad, pacific staghorn sculpin, shokihazi goby, starry flounder.

```{r}
FishList<-unique(SMFS_OTR_Thesis_WithZeros$OrganismCode)
FishList<- c("STBK", "SB", "SCP", "ISS", "LFS", "SG", "ASH", "YFG", "TFS", "STAG", "SF")
```

### Water Quality
```{r}
# Create a function to generate histograms
generate_histograms <- function(data, fish_species, variables) {
  data %>%
    filter(OrganismCode %in% fish_species) %>%
    gather(variable, value, all_of(variables)) %>%
    ggplot(aes(x = value, fill = variable)) +
    geom_histogram(binwidth = 1, position = "dodge", alpha = 0.5) +
    facet_wrap(~ variable, scales = "free") +
    labs(title = "Frequency Distribution of CPUE by Environmental Variable",
         x = "Value",
         y = "Frequency") +
    theme_minimal()
}

# Example usage of the function
generate_histograms(SMFS_OTR_Thesis_WithZeros, FishList, c("WaterTemperature", "Salinity", "DO", "Secchi"))

# Create a function to generate separate sets of histograms for each fish species
generate_individual_histograms <- function(data, fish_species, variables) {
  for (species_code in fish_species) {
    data_subset <- data %>%
      filter(OrganismCode == species_code)
    
    if (nrow(data_subset) > 0) {
      p <- data_subset %>%
        gather(variable, value, all_of(variables)) %>%
        ggplot(aes(x = value, fill = variable)) +
        geom_histogram(binwidth = 1, position = "dodge", alpha = 0.5) +
        facet_wrap(~ variable, scales = "free") +
        labs(title = paste("Frequency Distribution for", species_code),
             x = "Value",
             y = "Frequency") +
        theme_minimal()
      
      print(p)
    }
  }
}

# Example usage of the function
generate_individual_histograms(SMFS_OTR_Thesis_WithZeros, FishList, c("WaterTemperature", "Salinity", "DO", "Secchi"))


generate_individual_bar_plots <- function(data, fish_species, variables) {
  for (species_code in fish_species) {
    data_subset <- data %>%
      filter(OrganismCode == species_code)
    
    if (nrow(data_subset) > 0) {
      p <- data_subset %>%
        gather(variable, value, all_of(variables)) %>%
        group_by(variable, value) %>%
        summarise(sum_CPUE = sum(CPUE, na.rm = TRUE)) %>%
        ggplot(aes(x = value, y = sum_CPUE, fill = variable)) +
        geom_col(width=1) +
        facet_wrap(~ variable, scales = "free") +
        labs(title = paste("CPUE Distribution for", species_code),
             x = "Value",
             y = "Total CPUE") +  
        theme_minimal()
      
      print(p)
    }
  }
}

# Example usage of the function
generate_individual_bar_plots(SMFS_OTR_Thesis_WithZeros, FishList, c("WaterTemperature", "Salinity", "DO", "Secchi"))


#facet_grid
WaterFacet<-SMFS_OTR_Thesis_WithZeros %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = WaterTemperature, y = CPUE)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal()

SecchiFacet<-SMFS_OTR_Thesis_WithZeros %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = Secchi, y = CPUE)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal()

DOFacet<-SMFS_OTR_Thesis_WithZeros %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = DO, y = CPUE)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal()

SalinityFacet<-SMFS_OTR_Thesis_WithZeros %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = Salinity, y = CPUE)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal()
```

### Temporal
```{r}
YearFacet<-SMFS_OTR_Thesis_WithZeros %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = Year, y = CPUE)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal() + theme(axis.text.x = element_text(angle=45))

MonthFacet<-SMFS_OTR_Thesis_WithZeros %>% filter(OrganismCode %in% FishList) %>% 
        ggplot(aes(x = Month, y = CPUE)) +
        geom_col(width=1) +
        facet_wrap(~OrganismCode, scales = "free") +
        theme_minimal() #+ theme(axis.text.x = element_text(angle=45))

SizeFacet<-SMFS_OTR_Thesis_WithZeros %>% filter(OrganismCode %in% FishList & StandardLength>0) %>% 
        ggplot(aes(x = Month, y = CPUE)) +
        geom_col(width=1) +
        facet_grid(Year~OrganismCode) +
        theme_minimal() 
```

### Demographics
```{r Demographics}
SizeFacet<-SMFS_OTR_Thesis_WithZeros %>% filter(OrganismCode %in% FishList & StandardLength>0) %>% 
        ggplot(aes(x = StandardLength, y = CPUE)) +
        geom_col(width=1) +
        facet_grid(Month~OrganismCode, scales = "free") +
        theme_minimal() + xlab("Standard Length (mm)")
```

## Other plots
```{r}
SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "TP") %>% 
  ggplot(aes(x = WaterTemperature, y = Count)) +
  geom_col(position = "dodge") +
  labs(x = "Water Temp", y = "Catch Frequency", title = "Tule Perch Catch Frequency by Water Temp") +
  theme_minimal() 

```


```{r}

CatchFrequency <- function(data, x, y, title) {
  ggplot(data) +
    aes({{x}}, {{y}}) +
    geom_col(position = "dodge") +
    labs(x = deparse(substitute(x)), y = deparse(substitute(y)), title = title) +
    theme_minimal()
} #deparse automatically pulls the name from x and y to label the axes. This function is to make plotting more streamlined :)

#Water Temp graph for TP 2011-2023
WT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "TP", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "TP & Water Temp SMFS 2011-2023")
#DO Graph for TP  2011-2023
DO.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "TP", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "TP & DO SMFS 2011-2023")
#Salinity Graph for TP 2011-2023
PPT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "TP", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "TP & Salinity SMFS 2011-2023")
#Secchi Graph for TP 2011-2023
Secchi.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "TP", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "TP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Striped Bass 2011-2023
WT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SB", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "SB & Water Temp SMFS 2011-2023")
#DO Graph for SB  2011-2023
DO.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SB", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "SB & DO SMFS 2011-2023")
#Salinity Graph for SB 2011-2023
PPT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SB", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "SB & Salinity SMFS 2011-2023")
#Secchi Graph for SB 2011-2023
Secchi.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SB", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "SB & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Prickly Sculpin 2011-2023
WT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SCP", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "SCP & Water Temp SMFS 2011-2023")
#DO Graph for SCP  2011-2023
DO.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SCP", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "SCP & DO SMFS 2011-2023")
#Salinity Graph for SCP 2011-2023
PPT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SCP", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "SCP & Salinity SMFS 2011-2023")
#Secchi Graph for SCP 2011-2023
Secchi.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SCP", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "SCP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Longfin Smelt 2011-2023
WT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "LFS", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "LFS & Water Temp SMFS 2011-2023")
#DO Graph for LFS  2011-2023
DO.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "LFS", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "LFS & DO SMFS 2011-2023")
#Salinity Graph for LFS 2011-2023
PPT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "LFS", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "LFS & Salinity SMFS 2011-2023")
#Secchi Graph for LFS 2011-2023
Secchi.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "LFS", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "LFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Yellowfin Goby 2011-2023
WT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "YFG", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "YFG & Water Temp SMFS 2011-2023")
#DO Graph for YFG  2011-2023
DO.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "YFG", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "YFG & DO SMFS 2011-2023")
#Salinity Graph for YFG 2011-2023
PPT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "YFG", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "YFG & Salinity SMFS 2011-2023")
#Secchi Graph for YFG 2011-2023
Secchi.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "YFG", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "YFG & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for American Shad 2011-2023
WT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "ASH", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "ASH & Water Temp SMFS 2011-2023")
#DO Graph for ASH  2011-2023
DO.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "ASH", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "ASH & DO SMFS 2011-2023")
#Salinity Graph for ASH 2011-2023
PPT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "ASH", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "ASH & Salinity SMFS 2011-2023")
#Secchi Graph for ASH 2011-2023
Secchi.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "ASH", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "ASH & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Threadfin Shad 2011-2023
WT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "TFS", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "TFS & Water Temp SMFS 2011-2023")
#DO Graph for TFS  2011-2023
DO.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "TFS", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "TFS & DO SMFS 2011-2023")
#Salinity Graph for TFS 2011-2023
PPT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "TFS", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "TFS & Salinity SMFS 2011-2023")
#Secchi Graph for TFS 2011-2023
Secchi.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "TFS", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "TFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for Starry Flounder 2011-2023
WT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SF", !is.na(WaterTemperature), !is.na(Count)) %>%
  CatchFrequency(WaterTemperature, Count, title = "SF & Water Temp SMFS 2011-2023")
#DO Graph for SF  2011-2023
DO.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SF", !is.na(DO), !is.na(Count)) %>%
  CatchFrequency(DO, Count, title = "SF & DO SMFS 2011-2023")
#Salinity Graph for SF 2011-2023
PPT.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SF", !is.na(Salinity), !is.na(Count)) %>%
  CatchFrequency(Salinity, Count, title = "SF & Salinity SMFS 2011-2023")
#Secchi Graph for SF 2011-2023
Secchi.Plot<-SMFS_OTR_Thesis_WithZeros %>% 
  filter(OrganismCode %in% "SF", !is.na(Secchi), !is.na(Count)) %>%
  CatchFrequency(Secchi, Count, title = "SF & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")


```

```{r}


#Lets plot WaterTemp CPUE now
# Step 1: Sum count over each unique sample row ID
summed_data <- SMFS_OTR_Thesis_WithZeros %>%
  group_by(SampleRowID, OrganismCode, WaterTemperature) %>%
  summarize(SumCount = sum(Count),
            n=n(SampleRowID),
            CPUE = SumCount/n())

# Step 2: Calculate catch per unit effort
#I want CPUE for each water quality parameter

#CPUE = catch per 5 minute trawl (filter out durations outside of norm) (so could split 10 min trawl catch in half or calculate them separately). For now. 
#Use SampleRowID as unique trawls. Columns: SampleRowID, Metadata, OrganismCode, Count (size will come later), Site.

CPUE_5min_Temp <- SMFS_OTR_Thesis_WithZeros %>% filter(TowDuration == 5) %>% group_by(WaterTemperature, OrganismCode) %>% summarize(CPUE = sum(Count)/n(), n = n(), Count = Count)

CPUE_10min_Temp <- SMFS_OTR_Thesis_WithZeros %>% filter(TowDuration == 10) %>% group_by(WaterTemperature, OrganismCode) %>% summarize(CPUE = sum(Count)/n(), n = n(), Count = Count)


#Lets run a check real quick
#Removing NAs from Tow Duration since we won't have CPUE from them
SMFS_OTR_Thesis_WithZeros_NoTowNA<-SMFS_OTR_Thesis_WithZeros %>% filter(!is.na(TowDuration)) #333872

Five<-SMFS_OTR_Thesis_WithZeros_NoTowNA %>% filter(TowDuration == 5) #237628, so matches the CPUE calculation
Ten<-SMFS_OTR_Thesis_WithZeros_NoTowNA %>% filter(TowDuration == 10) #93027, matches CPUE calculation
Other<-SMFS_OTR_Thesis_WithZeros_NoTowNA %>% filter(TowDuration != 5, 
                                                    TowDuration != 10) #3217
3217+237628+93027 #checks out!

CPUE_5min_DO <- SMFS_OTR_Thesis_WithZeros %>% filter(TowDuration == 5) %>% group_by(DO, OrganismCode) %>% summarize(CPUE = sum(Count)/n(), n = n(), Count = Count)

CPUE_10min_DO <- SMFS_OTR_Thesis_WithZeros %>% filter(TowDuration == 10) %>% group_by(DO, OrganismCode) %>% summarize(CPUE = sum(Count)/n(), n = n(), Count = Count)

CPUE_5min_PPT <- SMFS_OTR_Thesis_WithZeros %>% filter(TowDuration == 5) %>% group_by(Salinity, OrganismCode) %>% summarize(CPUE = sum(Count)/n(), n = n(), Count = Count)

CPUE_10min_PPT <- SMFS_OTR_Thesis_WithZeros %>% filter(TowDuration == 10) %>% group_by(Salinity, OrganismCode) %>% summarize(CPUE = sum(Count)/n(), n = n(), Count = Count)

CPUE_5min_Secchi <- SMFS_OTR_Thesis_WithZeros %>% filter(TowDuration == 5) %>% group_by(Secchi, OrganismCode) %>% summarize(CPUE = sum(Count)/n(), n = n(), Count = Count)

CPUE_10min_Secchi <- SMFS_OTR_Thesis_WithZeros %>% filter(TowDuration == 10) %>% group_by(Secchi, OrganismCode) %>% summarize(CPUE = sum(Count)/n(), n = n(), Count = Count)

#Plot CPUE Now
CatchFrequency <- function(data, x, y, title) {
  ggplot(data) +
    aes({{x}}, {{y}}) +
    geom_col(position = "dodge") +
    labs(x = deparse(substitute(x)), y = deparse(substitute(y)), title = title) +
    theme_minimal() + scale_x_continuous(breaks = seq(0, 1000, 5)) + scale_y_continuous(breaks = seq(0, 50, 1))
}
#Water Temp graph for TP 2011-2023
WT.Plot<-CPUE_5min_Temp %>% 
  filter(OrganismCode %in% "TP", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "5 min Trawl Catch per Trawl of TP & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for TP  2011-2023
DO.Plot<-CPUE_5min_DO %>% 
  filter(OrganismCode %in% "TP", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "5 min Trawl Catch per Trawl of TP & DO SMFS 2011-2023")
#Salinity Graph for TP 2011-2023
PPT.Plot<-CPUE_5min_PPT %>% 
  filter(OrganismCode %in% "TP", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "5 min Trawl Catch per Trawl of TP & Salinity SMFS 2011-2023")
#Secchi Graph for TP 2011-2023
Secchi.Plot<-CPUE_5min_Secchi %>% 
  filter(OrganismCode %in% "TP", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "5 min Trawl Catch per Trawl of TP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for TP 2011-2023
WT.Plot<-CPUE_10min_Temp %>% 
  filter(OrganismCode %in% "TP", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "10 min Trawl Catch per Trawl of TP & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for TP  2011-2023
DO.Plot<-CPUE_10min_DO %>% 
  filter(OrganismCode %in% "TP", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "10 min Trawl Catch per Trawl of TP & DO SMFS 2011-2023")
#Salinity Graph for TP 2011-2023
PPT.Plot<-CPUE_10min_PPT %>% 
  filter(OrganismCode %in% "TP", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "10 min Trawl Catch per Trawl of TP & Salinity SMFS 2011-2023")
#Secchi Graph for TP 2011-2023
Secchi.Plot<-CPUE_10min_Secchi %>% 
  filter(OrganismCode %in% "TP", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "10 min Trawl Catch per Trawl of TP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")




#Water Temp CPUE graph for SB 2011-2023
WT.Plot<-CPUE_5min_Temp %>% 
  filter(OrganismCode %in% "SB", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "5 min Trawl Catch per Trawl of SB & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SB  2011-2023
DO.Plot<-CPUE_5min_DO %>% 
  filter(OrganismCode %in% "SB", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "5 min Trawl Catch per Trawl of SB & DO SMFS 2011-2023")
#Salinity Graph for SB 2011-2023
PPT.Plot<-CPUE_5min_PPT %>% 
  filter(OrganismCode %in% "SB", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "5 min Trawl Catch per Trawl of SB & Salinity SMFS 2011-2023")
#Secchi Graph for SB 2011-2023
Secchi.Plot<-CPUE_5min_Secchi %>% 
  filter(OrganismCode %in% "SB", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "5 min Trawl Catch per Trawl of SB & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for SB 2011-2023
WT.Plot<-CPUE_10min_Temp %>% 
  filter(OrganismCode %in% "SB", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "10 min Trawl Catch per Trawl of SB & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SB  2011-2023
DO.Plot<-CPUE_10min_DO %>% 
  filter(OrganismCode %in% "SB", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "10 min Trawl Catch per Trawl of SB & DO SMFS 2011-2023")
#Salinity Graph for SB 2011-2023
PPT.Plot<-CPUE_10min_PPT %>% 
  filter(OrganismCode %in% "SB", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "10 min Trawl Catch per Trawl of SB & Salinity SMFS 2011-2023")
#Secchi Graph for SB 2011-2023
Secchi.Plot<-CPUE_10min_Secchi %>% 
  filter(OrganismCode %in% "SB", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "10 min Trawl Catch per Trawl of SB & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")






#Water Temp CPUE graph for SCP 2011-2023
WT.Plot<-CPUE_5min_Temp %>% 
  filter(OrganismCode %in% "SCP", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "5 min Trawl Catch per Trawl of SCP & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SCP  2011-2023
DO.Plot<-CPUE_5min_DO %>% 
  filter(OrganismCode %in% "SCP", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "5 min Trawl Catch per Trawl of SCP & DO SMFS 2011-2023")
#Salinity Graph for SCP 2011-2023
PPT.Plot<-CPUE_5min_PPT %>% 
  filter(OrganismCode %in% "SCP", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "5 min Trawl Catch per Trawl of SCP & Salinity SMFS 2011-2023")
#Secchi Graph for SCP 2011-2023
Secchi.Plot<-CPUE_5min_Secchi %>% 
  filter(OrganismCode %in% "SCP", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "5 min Trawl Catch per Trawl of SCP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for SCP 2011-2023
WT.Plot<-CPUE_10min_Temp %>% 
  filter(OrganismCode %in% "SCP", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "10 min Trawl Catch per Trawl of SCP & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SCP  2011-2023
DO.Plot<-CPUE_10min_DO %>% 
  filter(OrganismCode %in% "SCP", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "10 min Trawl Catch per Trawl of SCP & DO SMFS 2011-2023")
#Salinity Graph for SCP 2011-2023
PPT.Plot<-CPUE_10min_PPT %>% 
  filter(OrganismCode %in% "SCP", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "10 min Trawl Catch per Trawl of SCP & Salinity SMFS 2011-2023")
#Secchi Graph for SCP 2011-2023
Secchi.Plot<-CPUE_10min_Secchi %>% 
  filter(OrganismCode %in% "SCP", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "10 min Trawl Catch per Trawl of SCP & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")







#Water Temp CPUE graph for LFS 2011-2023
WT.Plot<-CPUE_5min_Temp %>% 
  filter(OrganismCode %in% "LFS", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "5 min Trawl Catch per Trawl of LFS & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for LFS  2011-2023
DO.Plot<-CPUE_5min_DO %>% 
  filter(OrganismCode %in% "LFS", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "5 min Trawl Catch per Trawl of LFS & DO SMFS 2011-2023")
#Salinity Graph for LFS 2011-2023
PPT.Plot<-CPUE_5min_PPT %>% 
  filter(OrganismCode %in% "LFS", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "5 min Trawl Catch per Trawl of LFS & Salinity SMFS 2011-2023")
#Secchi Graph for LFS 2011-2023
Secchi.Plot<-CPUE_5min_Secchi %>% 
  filter(OrganismCode %in% "LFS", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "5 min Trawl Catch per Trawl of LFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for LFS 2011-2023
WT.Plot<-CPUE_10min_Temp %>% 
  filter(OrganismCode %in% "LFS", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "10 min Trawl Catch per Trawl of LFS & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for LFS  2011-2023
DO.Plot<-CPUE_10min_DO %>% 
  filter(OrganismCode %in% "LFS", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "10 min Trawl Catch per Trawl of LFS & DO SMFS 2011-2023")
#Salinity Graph for LFS 2011-2023
PPT.Plot<-CPUE_10min_PPT %>% 
  filter(OrganismCode %in% "LFS", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "10 min Trawl Catch per Trawl of LFS & Salinity SMFS 2011-2023")
#Secchi Graph for LFS 2011-2023
Secchi.Plot<-CPUE_10min_Secchi %>% 
  filter(OrganismCode %in% "LFS", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "10 min Trawl Catch per Trawl of LFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")












#Water Temp CPUE graph for YFG 2011-2023
WT.Plot<-CPUE_5min_Temp %>% 
  filter(OrganismCode %in% "YFG", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "5 min Trawl Catch per Trawl of YFG & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for YFG  2011-2023
DO.Plot<-CPUE_5min_DO %>% 
  filter(OrganismCode %in% "YFG", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "5 min Trawl Catch per Trawl of YFG & DO SMFS 2011-2023")
#Salinity Graph for YFG 2011-2023
PPT.Plot<-CPUE_5min_PPT %>% 
  filter(OrganismCode %in% "YFG", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "5 min Trawl Catch per Trawl of YFG & Salinity SMFS 2011-2023")
#Secchi Graph for YFG 2011-2023
Secchi.Plot<-CPUE_5min_Secchi %>% 
  filter(OrganismCode %in% "YFG", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "5 min Trawl Catch per Trawl of YFG & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for YFG 2011-2023
WT.Plot<-CPUE_10min_Temp %>% 
  filter(OrganismCode %in% "YFG", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "10 min Trawl Catch per Trawl of YFG & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for YFG  2011-2023
DO.Plot<-CPUE_10min_DO %>% 
  filter(OrganismCode %in% "YFG", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "10 min Trawl Catch per Trawl of YFG & DO SMFS 2011-2023")
#Salinity Graph for YFG 2011-2023
PPT.Plot<-CPUE_10min_PPT %>% 
  filter(OrganismCode %in% "YFG", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "10 min Trawl Catch per Trawl of YFG & Salinity SMFS 2011-2023")
#Secchi Graph for YFG 2011-2023
Secchi.Plot<-CPUE_10min_Secchi %>% 
  filter(OrganismCode %in% "YFG", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "10 min Trawl Catch per Trawl of YFG & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")









#Water Temp CPUE graph for ASH 2011-2023
WT.Plot<-CPUE_5min_Temp %>% 
  filter(OrganismCode %in% "ASH", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "5 min Trawl Catch per Trawl of ASH & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for ASH  2011-2023
DO.Plot<-CPUE_5min_DO %>% 
  filter(OrganismCode %in% "ASH", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "5 min Trawl Catch per Trawl of ASH & DO SMFS 2011-2023")
#Salinity Graph for ASH 2011-2023
PPT.Plot<-CPUE_5min_PPT %>% 
  filter(OrganismCode %in% "ASH", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "5 min Trawl Catch per Trawl of ASH & Salinity SMFS 2011-2023")
#Secchi Graph for ASH 2011-2023
Secchi.Plot<-CPUE_5min_Secchi %>% 
  filter(OrganismCode %in% "ASH", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "5 min Trawl Catch per Trawl of ASH & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for ASH 2011-2023
WT.Plot<-CPUE_10min_Temp %>% 
  filter(OrganismCode %in% "ASH", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "10 min Trawl Catch per Trawl of ASH & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for ASH  2011-2023
DO.Plot<-CPUE_10min_DO %>% 
  filter(OrganismCode %in% "ASH", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "10 min Trawl Catch per Trawl of ASH & DO SMFS 2011-2023")
#Salinity Graph for ASH 2011-2023
PPT.Plot<-CPUE_10min_PPT %>% 
  filter(OrganismCode %in% "ASH", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "10 min Trawl Catch per Trawl of ASH & Salinity SMFS 2011-2023")
#Secchi Graph for ASH 2011-2023
Secchi.Plot<-CPUE_10min_Secchi %>% 
  filter(OrganismCode %in% "ASH", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "10 min Trawl Catch per Trawl of ASH & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

NoNASecchi<-SMFS_OTR_Thesis_WithZeros_NoTowNA %>% filter(!is.na(Secchi))
range(NoNASecchi$Secchi) #Max secchi is 99! Catches over 99 are unmeasurable (possibly written as 99?) since we only bring out a meter stick.











#Water Temp CPUE graph for TFS 2011-2023
WT.Plot<-CPUE_5min_Temp %>% 
  filter(OrganismCode %in% "TFS", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "5 min Trawl Catch per Trawl of TFS & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for TFS  2011-2023
DO.Plot<-CPUE_5min_DO %>% 
  filter(OrganismCode %in% "TFS", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "5 min Trawl Catch per Trawl of TFS & DO SMFS 2011-2023")
#Salinity Graph for TFS 2011-2023
PPT.Plot<-CPUE_5min_PPT %>% 
  filter(OrganismCode %in% "TFS", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "5 min Trawl Catch per Trawl of TFS & Salinity SMFS 2011-2023")
#Secchi Graph for TFS 2011-2023
Secchi.Plot<-CPUE_5min_Secchi %>% 
  filter(OrganismCode %in% "TFS", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "5 min Trawl Catch per Trawl of TFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for TFS 2011-2023
WT.Plot<-CPUE_10min_Temp %>% 
  filter(OrganismCode %in% "TFS", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "10 min Trawl Catch per Trawl of TFS & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for TFS  2011-2023
DO.Plot<-CPUE_10min_DO %>% 
  filter(OrganismCode %in% "TFS", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "10 min Trawl Catch per Trawl of TFS & DO SMFS 2011-2023")
#Salinity Graph for TFS 2011-2023
PPT.Plot<-CPUE_10min_PPT %>% 
  filter(OrganismCode %in% "TFS", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "10 min Trawl Catch per Trawl of TFS & Salinity SMFS 2011-2023")
#Secchi Graph for TFS 2011-2023
Secchi.Plot<-CPUE_10min_Secchi %>% 
  filter(OrganismCode %in% "TFS", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "10 min Trawl Catch per Trawl of TFS & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")











#Water Temp CPUE graph for SF 2011-2023
WT.Plot<-CPUE_5min_Temp %>% 
  filter(OrganismCode %in% "SF", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "5 min Trawl Catch per Trawl of SF & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SF  2011-2023
DO.Plot<-CPUE_5min_DO %>% 
  filter(OrganismCode %in% "SF", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "5 min Trawl Catch per Trawl of SF & DO SMFS 2011-2023")
#Salinity Graph for SF 2011-2023
PPT.Plot<-CPUE_5min_PPT %>% 
  filter(OrganismCode %in% "SF", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "5 min Trawl Catch per Trawl of SF & Salinity SMFS 2011-2023")
#Secchi Graph for SF 2011-2023
Secchi.Plot<-CPUE_5min_Secchi %>% 
  filter(OrganismCode %in% "SF", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "5 min Trawl Catch per Trawl of SF & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#Water Temp graph for SF 2011-2023
WT.Plot<-CPUE_10min_Temp %>% 
  filter(OrganismCode %in% "SF", !is.na(WaterTemperature)) %>%
  CatchFrequency(WaterTemperature, CPUE, title = "10 min Trawl Catch per Trawl of SF & Water Temp SMFS 2011-2023")
WT.Plot

#DO Graph for SF  2011-2023
DO.Plot<-CPUE_10min_DO %>% 
  filter(OrganismCode %in% "SF", !is.na(DO)) %>%
  CatchFrequency(DO, CPUE, title = "10 min Trawl Catch per Trawl of SF & DO SMFS 2011-2023")
#Salinity Graph for SF 2011-2023
PPT.Plot<-CPUE_10min_PPT %>% 
  filter(OrganismCode %in% "SF", !is.na(Salinity)) %>%
  CatchFrequency(Salinity, CPUE, title = "10 min Trawl Catch per Trawl of SF & Salinity SMFS 2011-2023")
#Secchi Graph for SF 2011-2023
Secchi.Plot<-CPUE_10min_Secchi %>% 
  filter(OrganismCode %in% "SF", !is.na(Secchi)) %>%
  CatchFrequency(Secchi, CPUE, title = "10 min Trawl Catch per Trawl of SF & Secchi SMFS 2011-2023")
# Arrange plots into a single image
plot_grid(WT.Plot, DO.Plot, PPT.Plot, Secchi.Plot, ncol = 2, labels = "AUTO")

#NEXT: Bin original dataframe (fewer rows but higher counts, column with Species_BinSize and do complete on that.)
glimpse(SMFS_OTR_Thesis_WithZeros)
glimpse(SMFS_AgesBySizeMo)

#Need to do this before adding zeros. New script!

```